(function(a){a.cookie=function(h,g,l){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(g))||g===null||g===undefined)){l=a.extend({},l);if(g===null||g===undefined){l.expires=-1}if(typeof l.expires==="number"){var j=l.expires,k=l.expires=new Date();k.setDate(k.getDate()+j)}g=String(g);return(document.cookie=[encodeURIComponent(h),"=",l.raw?g:encodeURIComponent(g),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join(""))}l=g||{};var b=l.raw?function(i){return i}:decodeURIComponent;var c=document.cookie.split("; ");for(var f=0,e;e=c[f]&&c[f].split("=");f++){if(b(e[0])===h){return b(e[1]||"")}}return null}})(jQuery);!function(c){function b(f,e){e.find("> .active").removeClass("active").find("> .dropdown-menu > .active").removeClass("active");f.addClass("active");if(f.parent(".dropdown-menu")){f.closest("li.dropdown").addClass("active")}}function a(j){var i=c(this),g=i.closest("ul:not(.dropdown-menu)"),f=i.attr("href"),h,k;if(/^#\w+/.test(f)){j.preventDefault();if(i.parent("li").hasClass("active")){return}h=g.find(".active a").last()[0];k=c(f);b(i.parent("li"),g);b(k,k.parent());i.trigger({type:"change",relatedTarget:h})}}c.fn.tabs=c.fn.pills=function(e){return this.each(function(){c(this).delegate(e||".tabs li > a, .pills > li > a","click",a)})};c(document).ready(function(){c("body").tabs("ul[data-tabs] li > a, ul[data-pills] > li > a")})}(window.jQuery||window.ender);function asyncjsload__(b){var c=document.createElement("script");var a=document.getElementsByTagName("script")[0];c.type="text/javascript";c.async=true;c.src=b;a.parentNode.insertBefore(c,a)}var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-17894100-2"]);_gaq.push(["_trackPageview"]);function jsloadertimeout__(){asyncjsload__("http://c.supportchamp.com/core.js?d=d0f5fee4845a0d53");asyncjsload__("http://www.google-analytics.com/ga.js");asyncjsload__("https://apis.google.com/js/plusone.js")}if(window.location.host=="mailnesia.com"){setTimeout(jsloadertimeout__,1)}if(/^http:\/\/[^\/]+(\/[a-z][a-z])?\/?$/.test(window.location.href)){window.onload=function(){$("#mailbox").focus()}}var d=new Date();$.cookie("tz",d.getTimezoneOffset(),{path:"/mailbox"});function confirmDeleteEmail(){$("#delete_email").html("<i>Are you sure you want to delete this email?</i><input type='button' class='btn danger' onclick='deleteEmail()' value='YES delete it !'>")}function confirmEmptyMailbox(){$("#empty_mailbox").html("<i>Are you sure you want to delete all emails in this mailbox?</i><input type='button' class='btn danger' onclick='wipeMailbox()' value='YES delete them !'>")}function deleteEmail(){$.ajax({url:window.location.href,type:"POST",data:{"delete":1},success:function(a){$("#delete_email").html(a)},error:function(a){$("#delete_email").html('<span class="alert-message error">HTTP ERROR '+a.status+"</span>")}})}function wipeMailbox(){$.ajax({url:window.location.href,type:"POST",data:{"delete":1},success:function(a){$("#empty_mailbox").html(a)},error:function(a){$("#empty_mailbox").html('<span class="alert-message error">HTTP ERROR '+a.status+"</span>")}})}if(/\/mailbox\/[^\/]+\/?$/.test(window.location.href)){var pageNumber=/p=([0-9]+)/.exec(window.location.href);if(pageNumber==null||!(pageNumber[1]>0)){setInterval(function(){var a="table.email>tbody>tr:first-child";var b=$(a).attr("id")||1;$.get(window.location.href,{newerthan:b,noheadernofooter:1},function(c,f,e){if(e.status==200){if(b==1){$("h2.emails").remove();$("table.email>tbody").html(c)}else{$(c).insertBefore(a)}}})},60000)}}function openEmail(b,c){var a="#emailbody_"+c;if($(a).length){if(!$(a+" td div.alert-message.error").length){if($(a).is(":visible")){$(a).hide("fast");$("tr#"+c).addClass("even").removeClass("odd")}else{if($(a).is(":hidden")){$(a).show("fast");$("tr#"+c).addClass("odd").removeClass("even")}}return}}else{$('<tr id="emailbody_'+c+'"><td style="padding: 0;" colspan="5"><p>LOADING<p></td></tr>').insertAfter("#"+c);$("tr#"+c).addClass("odd")}$.ajax({url:"/mailbox/"+b+"/"+c+"?noheadernofooter=ajax",success:function(e){$(a+" td").html(e)},error:function(e){$(a+" td").html('<div class="alert-message error">Error!  HTTP '+e.status+" "+e.statusText+"</div>")}})}if(/\/mailbox\/[^\/]+\/?(?:\?.*)*$/.test(window.location.href)&&$("div.pagination").length){var currentPage=/p=([0-9]+)/.exec(window.location.href);var nextPage=(currentPage==null)?1:++currentPage[1];var autoPager=function(){var b=$(document).scrollTop();var e=$(document).height();var f=$(window).height();if(e-b-f<500){var a="table.email>tbody>tr:last";var c=/\/mailbox\/([^\/\?]+)/.exec(window.location.href);if(!c[1]){clearInterval(intervalID);return}$.ajax({url:"/mailbox/"+c[1]+"?noheadernofooter=autopager&p="+nextPage,success:function(g){if(g.length==0){clearInterval(intervalID)}else{$(a).after(g);nextPage++}},error:function(g){$(a).after('<tr><td colspan="5"><div class="alert-message error">Error!  HTTP '+g.status+" "+g.statusText+"</div></td></tr>")}})}};var intervalID=setInterval(function(){autoPager()},1000)}function setLanguage(c,a){$.cookie("language",c,{path:"/"});var b=/\/mailbox\/.+/.exec(window.location.href);if(b){window.location.reload(true);return false}else{if(c=="en"||!a){window.location.href="/"}else{window.location.href="/"+c+"/"}return false}}function toggleClicker(){$.ajax({url:window.location.href+"/clicker",type:"POST",data:{set_clicker:$("#clicker_checkbox").is(":checked")?1:0},success:function(a){$("#clicker-status").html(a)},error:function(a){$("#clicker-status").html('<span class="alert-message error">'+get_error_message(a)+"</span>")}})}$(document).ready(function(){$("#add_new_alias_form").bind("click",function(b){var c=$.cookie("mailbox");var a='<form method="post" action="#" onsubmit="return false;"><input type="text" name="alias" tabindex="10" size="20" maxlength="30" class="xlarge" title="alias"><input type="hidden" name="mailbox" value="'+c+'"><input type="hidden" name="remove_alias" value=""><input type="submit" name="ok" value="Ok" class="btn primary"><input type="submit" name="delete" value="Delete" class="btn danger" style="display: none;" ></form>';$("ol").append('<li class="form"><div class="alias_result"></div><div class="alias_form">'+a+"</div></li>");bind_submit_ok("li:last>div>form");bind_submit_delete("li:last>div>form")});bind_submit_ok("li>div>form");bind_submit_delete("li>div>form")});function bind_submit_ok(a){$(a).bind("submit",function(){return false});$(a+'>input[name="ok"]').bind("click",function(e){var f=$(this).siblings('input[name="mailbox"]').val();var c=$(this).siblings('input[name="alias"]').val();var b=$(this).siblings('input[name="remove_alias"]').val();if(!(c&&f)){return false}if(b){if(c==b){return false}$.ajax({url:"/settings/"+f+"/alias/modify",type:"POST",data:{alias:c,remove_alias:b},success:function(g){$(e.target).parent().parent().prev("div").html('<span class="alert-message success">'+g+"</span>");$(e.target).parent().find('input[name="remove_alias"]').val(c)},error:function(g){$(e.target).parent().parent().prev("div").html('<span class="alert-message error">'+get_error_message(g)+"</span>")}})}else{$.ajax({url:"/settings/"+f+"/alias/set",type:"POST",data:{alias:c},success:function(g){$(e.target).parent().parent().prev("div").html('<span class="alert-message success">'+g+"</span>");$(e.target).parent().find('input[name="remove_alias"]').val(c);$(e.target).parent().find('input[name="delete"]').show()},error:function(g){$(e.target).parent().parent().prev("div").html('<span class="alert-message error">'+get_error_message(g)+"</span>")}})}})}function bind_submit_delete(a){$(a).bind("submit",function(){return false});$(a+'>input[name="delete"]').bind("click",function(c){var e=$(this).siblings('input[name="mailbox"]').val();var b=$(this).siblings('input[name="remove_alias"]').val();if(!(e&&b)){return false}$.ajax({url:"/settings/"+e+"/alias/remove",type:"POST",data:{remove_alias:b},success:function(f){$(c.target).parent().parent().prev("div").html('<span class="alert-message warning">'+f);$(c.target).parent().find('input[name="remove_alias"]').val("");$(c.target).parent().find('input[name="alias"]').val("");$(c.target).parent().find('input[name="delete"]').hide()},error:function(f){$(c.target).parent().parent().prev("div").html('<span class="alert-message error">'+get_error_message(f)+"</span>")}})})}function get_error_message(a){if(a.status>=502&&a.status<=504){return"Service down - please try again in a few seconds"}else{return a.responseText||a.statusText}};